summary(lm(hg.form.custom, data = dataset))
# > seems ok !
# The backward selection gives the same model than stepwise.
fit <- lm(hg.form.full2,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
summary(step)
selected.model = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + age:height + age:weight + age:fishpart + restime:weight + restime:fishmlwk + restime:fishpart + height:fishmlwk + height:fishpart + weight:fishpart
hg.lm.selected.model=lm(selected.model, data=dataset)
hg.lmFi.selected.model=lm(selected.model, data=dataset.fisherman)
hg.lmNF.selected.model=lm(selected.model, data=dataset.non_fisherman)
summary(hg.lm.selected.model)
summary(hg.lmFi.selected.model)
summary(hg.lmNF.selected.model)
plot(hg.lm.selected.model, which=1)
plot(hg.lm.selected.model, which=2)
plot(hg.lm.selected.model, which=3)
plot(hg.lm.selected.model, which=4)
plot(hg.lm.selected.model, which=5)
plot(hg.lm.selected.model, which=6)
dataset.without.inf=dataset[c(-6,-56,-70,-85),]
dataset.fisherman.without.inf=dataset.fisherman[c(-6,-56,-70,-85),]
dataset.non_fisherman.without.inf=dataset.non_fisherman[c(-6,-56,-70,-85),]
hg.lm.new.selected.model=lm(selected.model, data=dataset.without.inf)
hg.lmFi.new.selected.model=lm(selected.model, data=dataset.fisherman.without.inf)
hg.lmNF.new.selected.model=lm(selected.model, data=dataset.non_fisherman.without.inf)
summary(hg.lm.new.selected.model)
summary(hg.lmFi.new.selected.model)
summary(hg.lmNF.new.selected.model)
plot(hg.lm.new.selected.model, which=1)
plot(hg.lm.new.selected.model, which=2)
plot(hg.lm.new.selected.model, which=3)
plot(hg.lm.new.selected.model, which=4)
plot(hg.lm.new.selected.model, which=5)
plot(hg.lm.new.selected.model, which=6)
hg.rlm.selected.model <- rlm(selected.model, data=dataset)  # robust reg model
#hg.rlmFi.selected.model <- rlm(selected.model, data=dataset.fisherman)
#hg.rlmNF.selected.model <- rlm(selected.model, data=dataset.non_fisherman)
summary(hg.rlm.selected.model)
#summary(hg.rlmFi.selected.model)
#summary(hg.rlmNF.selected.model)
fit <- lm(hg.form.full,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
summary(step)
plot(step)
fit <- lm(hg.form.full,data=dataset.fisherman)
step <- stepAIC(fit, direction="both")
step$anova # display results
summary(step)
plot(step)
fit <- lm(TotHg~ age + restime + height + weight + fishmlwk, data=dataset.non_fisherman) # hg.form.full
step <- stepAIC(fit, direction="both")
step$anova # display results
summary(step)
plot(step)
hg.form.test <- LogTotHg ~ fisherman:(age + restime + weight + logFishmlwk)
vif(lm(hg.form.test,data=dataset))
fit <- lm(hg.form.test,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
summary(step)
plot(step)
# hg.rlm.test <- rlm(step$call$formula, data = dataset)
# summary(hg.rlm.test)
# plot(hg.rlm.test)
library(robust)
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fishpart + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:weight
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:weight
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:weight
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:fishmlwk
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:fishmlwk
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:weight
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:fishmlwk
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman
hg.form.custom = TotHg ~ weight + fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
library(GGally)
library(car) # contains the vif() and leveneTest() functions
# Loading data
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset$LogTotHg <- log(dataset$TotHg)
dataset$logFishmlwk <- log(dataset$fishmlwk + 1)
#Converting categorical variables into factors
dataset$fisherman <- factor(dataset$fisherman)
dataset$fishpart <- factor(dataset$fishpart)
ggplot(dataset, aes(group=fisherman, y=TotHg, fill=fisherman)) + geom_boxplot() + labs(y = "Total Hg concentration in the hair (mg/g)") + scale_x_discrete() + scale_fill_discrete(name = "Population", labels = c("Control group", "Fishermen")) + theme_bw()
t.test(x=dataset[which(dataset$fisherman==1),]$TotHg, y=dataset[which(dataset$fisherman==0),]$TotHg, alternative = "greater", var.equal=FALSE)
table(dataset$fisherman, dataset$fishmlwk)
ggplot(dataset, aes(fisherman, TotHg)) + geom_boxplot()
ggplot(dataset, aes(age, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10() ##Uncomment for log scales
ggplot(dataset, aes(restime, TotHg, colour = fisherman)) + geom_point()
ggplot(dataset, aes(height, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(weight, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(fishmlwk, TotHg, colour = fisherman)) + geom_boxplot()
ggplot(dataset, aes(fishpart, TotHg, colour = fisherman)) + geom_boxplot()
hg.form.full = TotHg~ fisherman + age + restime + height + weight + fishmlwk + fishpart #+ fisherman:(age + restime + height + weight + fishmlwk + fishpart) : we would like to pu these interactions also but the VIF doesn't work because of the aliased coefficients
hg.form.full2 = TotHg~ (age + restime + height + weight + fishpart)^2
vif(lm(hg.form.full,data=dataset))
vif(lm(hg.form.full2,data=dataset))
hg.form.pre_selection=TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart + fisherman:(age + restime + height + weight + fishmlwk + fishpart)
fit <- lm(hg.form.pre_selection,data=dataset)
selection <- stepAIC(fit, direction="both")
selection$anova # display results
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + restime + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk + fishpart)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + height + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(age + weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age:fisherman
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fishpart +  fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fishpart
hg.form.custom = TotHg ~ fisherman + age + restime + height + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete height
hg.form.custom = TotHg ~ fisherman + age + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete age
hg.form.custom = TotHg ~ fisherman + restime + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete restime
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:(weight + fishmlwk)
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:weight
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk + fisherman:fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman:fishmlwk
hg.form.custom = TotHg ~ fisherman + weight + fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman
hg.form.custom = TotHg ~ weight + fishmlwk
drop1(lm(hg.form.custom, data = dataset), test="F")
#>delete fisherman
hg.form.selected=TotHg ~ fisherman + weight + fishmlwk + fisherman:weight + fisherman:fishmlwk
hg.lm.selected.model=lm(hg.form.selected, data=dataset)
summary(hg.lm.selected_model)
ggplot(dataset, aes(age, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10() ##Uncomment for log scales
ggplot(dataset, aes(restime, TotHg, colour = fisherman)) + geom_point()
ggplot(dataset, aes(fishmlwk, TotHg, colour = fisherman)) + geom_boxplot()
hg.form.selected=TotHg ~ fisherman + weight + fishmlwk + fisherman:weight + fisherman:fishmlwk
hg.lm.selected.model=lm(hg.form.selected, data=dataset)
summary(hg.lm.selected.model)
