hg.lm.age = lm(hg.form.age, data=dataset) # Whole population
hg.lmFi.age = lm(hg.form.age, data=dataset.fisherman) # Fishermen population
hg.lmNF.age = lm(hg.form.age, data=dataset.non_fisherman) # Control population
# Diagnostic plots
par(mfrow=c(2,2))
plot(hg.lm.age)
mtext("TotHg as a function of age - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.age)
mtext("TotHg as a function of age - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.age)
mtext("TotHg as a function of age - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.restime = TotHg ~ restime
hg.lm.restime = lm(hg.form.restime, data=dataset)
hg.lmFi.restime = lm(hg.form.restime, data=dataset.fisherman)
hg.lmNF.restime = lm(hg.form.restime, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.restime)
mtext("TotHg as a function of restime - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.restime)
mtext("TotHg as a function of restime - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.restime)
mtext("TotHg as a function of restime - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.weight = TotHg ~ weight
hg.lm.weight = lm(hg.form.weight, data=dataset)
hg.lmFi.weight = lm(hg.form.weight, data=dataset.fisherman)
hg.lmNF.weight = lm(hg.form.weight, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.weight)
mtext("TotHg as a function of weight - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.weight)
mtext("TotHg as a function of weight - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.weight)
mtext("TotHg as a function of weight - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.height = TotHg ~ height
hg.lm.height = lm(hg.form.height, data=dataset)
hg.lmFi.height = lm(hg.form.height, data=dataset.fisherman)
hg.lmNF.height = lm(hg.form.height, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.height)
mtext("TotHg as a function of height - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.height)
mtext("TotHg as a function of height - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.height)
mtext("TotHg as a function of height - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fishmlwk = TotHg ~ fishmlwk
hg.lm.fishmlwk = lm(hg.form.fishmlwk, data=dataset)
hg.lmFi.fishmlwk = lm(hg.form.fishmlwk, data=dataset.fisherman)
hg.lmNF.fishmlwk = lm(hg.form.fishmlwk, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.fishmlwk)
mtext("TotHg as a function of fishmlwk - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.fishmlwk)
mtext("TotHg as a function of fishmlwk - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.fishmlwk)
mtext("TotHg as a function of fishmlwk - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
>>>>>>> 719f9212dae05a4a9fb583dec70263c223de971f
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset
dataset$fisherman <- factor(dataset$fisherman)
dataset$fishmlwk <- factor(dataset$fishmlwk)
dataset$fishpart <- factor(dataset$fishpart)
dataset.fisherman=dataset[which(dataset$fisherman==1),]
dataset.non_fisherman=dataset[which(dataset$fisherman==0),]
summary(dataset)
ggplot(dataset, aes(fisherman, TotHg)) + geom_boxplot()
ggplot(dataset, aes(age, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10() ##Uncomment for log scales
ggplot(dataset, aes(restime, TotHg, colour = fisherman)) + geom_point()
ggplot(dataset, aes(height, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(weight, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(fishmlwk, TotHg, colour = fisherman)) + geom_boxplot()
ggplot(dataset, aes(fishpart, TotHg, colour = fisherman)) + geom_boxplot()
hg.form.age = TotHg ~ age # 1-D regression
hg.lm.age = lm(hg.form.age, data=dataset) # Whole population
hg.lmFi.age = lm(hg.form.age, data=dataset.fisherman) # Fishermen population
hg.lmNF.age = lm(hg.form.age, data=dataset.non_fisherman) # Control population
# Diagnostic plots
par(mfrow=c(2,2))
plot(hg.lm.age)
mtext("TotHg as a function of age - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.age)
mtext("TotHg as a function of age - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.age)
mtext("TotHg as a function of age - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.restime = TotHg ~ restime
hg.lm.restime = lm(hg.form.restime, data=dataset)
hg.lmFi.restime = lm(hg.form.restime, data=dataset.fisherman)
hg.lmNF.restime = lm(hg.form.restime, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.restime)
mtext("TotHg as a function of restime - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.restime)
mtext("TotHg as a function of restime - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.restime)
mtext("TotHg as a function of restime - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.weight = TotHg ~ weight
hg.lm.weight = lm(hg.form.weight, data=dataset)
hg.lmFi.weight = lm(hg.form.weight, data=dataset.fisherman)
hg.lmNF.weight = lm(hg.form.weight, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.weight)
mtext("TotHg as a function of weight - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.weight)
mtext("TotHg as a function of weight - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.weight)
mtext("TotHg as a function of weight - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.height = TotHg ~ height
hg.lm.height = lm(hg.form.height, data=dataset)
hg.lmFi.height = lm(hg.form.height, data=dataset.fisherman)
hg.lmNF.height = lm(hg.form.height, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.height)
mtext("TotHg as a function of height - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.height)
mtext("TotHg as a function of height - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.height)
mtext("TotHg as a function of height - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fishmlwk = TotHg ~ fishmlwk
hg.lm.fishmlwk = lm(hg.form.fishmlwk, data=dataset)
hg.lmFi.fishmlwk = lm(hg.form.fishmlwk, data=dataset.fisherman)
hg.lmNF.fishmlwk = lm(hg.form.fishmlwk, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.fishmlwk)
mtext("TotHg as a function of fishmlwk - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.fishmlwk)
mtext("TotHg as a function of fishmlwk - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.fishmlwk)
mtext("TotHg as a function of fishmlwk - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fisherman = TotHg ~ fisherman
<<<<<<< HEAD
hg.aov.fisherman = aov(hg.form.fisherman)
hg.form.fisherman = TotHg ~ fisherman
hg.aov.fisherman = aov(hg.form.fisherman, data= dataset)
summary(hg.aov.fisherman)
hg.formula.full= TotHg~restime + height + weight + fishmlwk + fishpart
hg.lm.full=lm(hg.formula.full, data = dataset.fisherman)
hg.formula.reduced= TotHg~fisherman + fisherman:(restime + height + weight + fishmlwk + fishpart )
hg.lm.reduced=lm(hg.formula.reduced, data = dataset.fisherman)
hg.formula.full= TotHg~restime + height + weight + fishmlwk + fishpart
hg.lm.full=lm(hg.formula.full, data = dataset.fisherman)
hg.formula.reduced= TotHg~fisherman + fisherman:(restime + height + weight + fishmlwk + fishpart )
hg.lm.reduced=lm(hg.formula.reduced, data = dataset)
hg.formula.full2= TotHg~ (restime + height + weight + fishmlwk + fishpart)^2
hg.lm.full2=lm(hg.formula.full2, data = dataset.fisherman)
summary(hg.lm.full)
summary(hg.lm.reduced)
summary(hg.lm.full2)
hg.formula.full= TotHg~restime + height + weight + fishmlwk + fishpart
hg.lm.full=lm(hg.formula.full, data = dataset.fisherman)
# Load here the libraries and packages you need for the rest of the analysis.
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset
dataset.fisherman=dataset[which(dataset$fisherman==1),]
dataset.non_fisherman=dataset[which(dataset$fisherman==0),]
plot(dataset.fisherman$weight, dataset.fisherman$TotHg, col= "green") + points(dataset.non_fisherman$weight, dataset.non_fisherman$TotHg, col= "red") #weight
plot(dataset.fisherman$age, dataset.fisherman$TotHg, col= "green") + points(dataset.non_fisherman$age, dataset.non_fisherman$TotHg, col= "red") #age
plot(dataset.fisherman$restime, dataset.fisherman$TotHg, col= "green") + points(dataset.non_fisherman$restime, dataset.non_fisherman$TotHg, col= "red")
boxplot(dataset$TotHg~dataset$fishpart, data=dataset)
boxplot(dataset$TotHg~dataset$fisherman)
hg.formula.full= TotHg~restime + height + weight + fishmlwk + fishpart
hg.lm.full=lm(hg.formula.full, data = dataset.fisherman)
hg.formula.reduced= TotHg~fisherman + fisherman:(restime + height + weight + fishmlwk + fishpart )
hg.lm.reduced=lm(hg.formula.reduced, data = dataset)
hg.formula.full2= TotHg~ (restime + height + weight + fishmlwk + fishpart)^2
hg.lm.full2=lm(hg.formula.full2, data = dataset.fisherman)
summary(hg.lm.full)
summary(hg.lm.reduced)
summary(hg.lm.full2)
pairs( ~ weight + fishmlwk + fishpart, data=dataset)
par(mfrow=c(1,2))
par(adj=0.5)
plot(dataset$TotHg ~ dataset$weight, pch=20, cex=1.5, xlim=c(0,100))
#pch is the type of point we use, and cex is the size of the points
abline(h=mean(dataset$TotHg), lty=2); abline(v=mean(dataset$weight), lty=2)
#lty is the type of line we use
title("Simple Correlation, TotHg vs wght")
text(20, 4, cex=1.5, paste("r =",round(cor(dataset$weight, dataset$TotHg), 2)))
#80, 4 sont les coordonnées du texte qu'on rajoute dans le graphe
cor(dataset$TotHg, dataset$fisherman)
aov.full=aov(formula = hg.formula.full, data = dataset)
summary(aov.full)
aov.reduced=aov(formula=hg.formula.reduced, data=dataset)
summary(aov.reduced)
anova(hg.lm.full, hg.lm.full2)
par(mfrow=c(1,2))
par(adj=0.5)
plot(dataset[which(dataset$TotHg<11),]$TotHg ~ dataset[which(dataset$TotHg<11),]$fishmlwk, pch=20, cex=1.5, xlim=c(0,10))
#pch is the type of point we use, and cex is the size of the points
abline(h=mean(dataset[which(dataset$TotHg<11),]$TotHg), lty=2); abline(v=mean(dataset[which(dataset$TotHg<11),]$fishmlwk), lty=2)
#lty is the type of line we use
title("Simple Correlation, TotHg vs wght")
text(2,10, cex=1.5, paste("r =",round(cor(dataset[which(dataset$TotHg<11),]$fishmlwk, dataset[which(dataset$TotHg<11),]$TotHg), 2)))
#80, 4 sont les coordonnées du texte qu'on rajoute dans le graphe
par(mfrow=c(1,2))
par(adj=0.5)
plot(dataset$TotHg ~ dataset$fishpart, pch=20, cex=1.5, xlim=c(0,10))
#pch is the type of point we use, and cex is the size of the points
abline(h=mean(dataset$TotHg), lty=2); abline(v=mean(dataset$fishmpart), lty=2)
#lty is the type of line we use
title("Simple Correlation, TotHg vs wght")
text(8.2, 15, cex=1.5, paste("r =",round(cor(dataset$fishpart, dataset$TotHg), 2)))
#80, 4 sont les coordonnées du texte qu'on rajoute dans le graphe
aov.full=aov(formula=hg.formula.full, data=dataset.fisherman)
summary(aov.full)
plot(hg.lm.full, which =1)
plot(hg.lm.full, which =2)
plot(hg.lm.full, which =3)
plot(hg.lm.full, which =4)
plot(hg.lm.full, which =5)
plot(hg.lm.full, which =6)
fit <- lm(,data=mydata)
fit <- lm(hg.formula.full,data=dataset)
step <- stepAIC(fit, direction="both")
install.packages("MASS")
library("MASS")
fit <- lm(hg.formula.full,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
=======
hg.aov.fisherman = aov(hg.form.fisherman, data= dataset)
summary(hg.aov.fisherman)
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
library(GGally)
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset$LogTotHg = log(dataset$TotHg)
dataset
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset$LogTotHg = log(dataset$TotHg)
summary(dataset)
ggpairs(dataset[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
ggpairs(dataset.fisherman[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
dataset.fisherman=dataset[which(dataset$fisherman==1),]
dataset.non_fisherman=dataset[which(dataset$fisherman==0),]
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
library(GGally)
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset$LogTotHg = log(dataset$TotHg)
>>>>>>> 719f9212dae05a4a9fb583dec70263c223de971f
dataset
dataset$fisherman <- factor(dataset$fisherman)
dataset$fishmlwk <- factor(dataset$fishmlwk)
dataset$fishpart <- factor(dataset$fishpart)
dataset.fisherman=dataset[which(dataset$fisherman==1),]
dataset.non_fisherman=dataset[which(dataset$fisherman==0),]
summary(dataset)
<<<<<<< HEAD
=======
ggpairs(dataset[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
ggpairs(dataset.fisherman[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
ggpairs(dataset.non_fisherman[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
>>>>>>> 719f9212dae05a4a9fb583dec70263c223de971f
ggplot(dataset, aes(fisherman, TotHg)) + geom_boxplot()
ggplot(dataset, aes(age, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10() ##Uncomment for log scales
ggplot(dataset, aes(restime, TotHg, colour = fisherman)) + geom_point()
ggplot(dataset, aes(height, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(weight, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(fishmlwk, TotHg, colour = fisherman)) + geom_boxplot()
ggplot(dataset, aes(fishpart, TotHg, colour = fisherman)) + geom_boxplot()
<<<<<<< HEAD
hg.form.age = TotHg ~ age # 1-D regression
hg.lm.age = lm(hg.form.age, data=dataset) # Whole population
hg.lmFi.age = lm(hg.form.age, data=dataset.fisherman) # Fishermen population
hg.lmNF.age = lm(hg.form.age, data=dataset.non_fisherman) # Control population
# Diagnostic plots
par(mfrow=c(2,2))
plot(hg.lm.age)
mtext("TotHg as a function of age - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.age)
mtext("TotHg as a function of age - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.age)
mtext("TotHg as a function of age - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.restime = TotHg ~ restime
hg.lm.restime = lm(hg.form.restime, data=dataset)
hg.lmFi.restime = lm(hg.form.restime, data=dataset.fisherman)
hg.lmNF.restime = lm(hg.form.restime, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.restime)
mtext("TotHg as a function of restime - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.restime)
mtext("TotHg as a function of restime - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.restime)
mtext("TotHg as a function of restime - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.weight = TotHg ~ weight
hg.lm.weight = lm(hg.form.weight, data=dataset)
hg.lmFi.weight = lm(hg.form.weight, data=dataset.fisherman)
hg.lmNF.weight = lm(hg.form.weight, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.weight)
mtext("TotHg as a function of weight - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.weight)
mtext("TotHg as a function of weight - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.weight)
mtext("TotHg as a function of weight - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.height = TotHg ~ height
hg.lm.height = lm(hg.form.height, data=dataset)
hg.lmFi.height = lm(hg.form.height, data=dataset.fisherman)
hg.lmNF.height = lm(hg.form.height, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.height)
mtext("TotHg as a function of height - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.height)
mtext("TotHg as a function of height - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.height)
mtext("TotHg as a function of height - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fishmlwk = TotHg ~ fishmlwk
hg.lm.fishmlwk = lm(hg.form.fishmlwk, data=dataset)
hg.lmFi.fishmlwk = lm(hg.form.fishmlwk, data=dataset.fisherman)
hg.lmNF.fishmlwk = lm(hg.form.fishmlwk, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.fishmlwk)
mtext("TotHg as a function of fishmlwk - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.fishmlwk)
mtext("TotHg as a function of fishmlwk - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.fishmlwk)
mtext("TotHg as a function of fishmlwk - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fisherman = TotHg ~ fisherman
hg.aov.fisherman = aov(hg.form.fisherman, data= dataset)
summary(hg.aov.fisherman)
fit <- lm(hg.formula.full,data=dataset)
hg.form.full = TotHg~restime + height + weight + fishmlwk + fishpart
fit <- lm(hg.form.full,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
hg.form.full2= TotHg~ (restime + height + weight + fishmlwk + fishpart)^2
fit2 <- lm(hg.form.full2,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
hg.form.full = TotHg~restime + height + weight + fishmlwk + fishpart
fit.fisherman <- lm(hg.form.full,data=dataset.fisherman)
step <- stepAIC(fit, direction="both")
step$anova # display results
hg.form.full = TotHg~restime + height + weight + fishmlwk + fishpart
fit.non_fisherman <- lm(hg.form.full,data=dataset.non_fisherman)
step <- stepAIC(fit, direction="both")
step$anova # display results
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
library(GGally)
install.packages("GGally")
=======
ggplot(dataset, aes(fisherman, TotHg)) + geom_boxplot()
t.test(dataset[which(dataset$fisherman==1),], dataset[which(dataset$fisherman==0),], alternative = "greater", var.equal=FALSE)
t.test(x=dataset[which(dataset$fisherman==1),], y=dataset[which(dataset$fisherman==0),], alternative = "greater", var.equal=FALSE)
t.test(x=dataset[which(dataset$fisherman==1),]$TotHg, y=dataset[which(dataset$fisherman==0),]$TotHg, alternative = "greater", var.equal=FALSE)
>>>>>>> 719f9212dae05a4a9fb583dec70263c223de971f
# Load here the libraries and packages you need for the rest of the analysis.
library(tidyverse)
library("MASS")
library(GGally)
DATA_FILE = "fishermen_mercury.csv" # Location of the data csv file
dataset = read.csv(DATA_FILE) # Loading the data
dataset$MeHg <- NULL # We are asked not to use the variable MeHg
dataset$LogTotHg = log(dataset$TotHg)
dataset
dataset$fisherman <- factor(dataset$fisherman)
dataset$fishmlwk <- factor(dataset$fishmlwk)
dataset$fishpart <- factor(dataset$fishpart)
dataset.fisherman=dataset[which(dataset$fisherman==1),]
dataset.non_fisherman=dataset[which(dataset$fisherman==0),]
summary(dataset)
ggpairs(dataset[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
ggpairs(dataset.fisherman[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
ggpairs(dataset.non_fisherman[, c("fisherman", "age", "weight", "restime", "fishmlwk", "fishpart")])
ggplot(dataset, aes(fisherman, TotHg)) + geom_boxplot()
ggplot(dataset, aes(age, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10() ##Uncomment for log scales
ggplot(dataset, aes(restime, TotHg, colour = fisherman)) + geom_point()
ggplot(dataset, aes(height, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(weight, TotHg, colour = fisherman)) + geom_point() #+ scale_y_log10() + scale_x_log10()
ggplot(dataset, aes(fishmlwk, TotHg, colour = fisherman)) + geom_boxplot()
ggplot(dataset, aes(fishpart, TotHg, colour = fisherman)) + geom_boxplot()
hg.form.age = TotHg ~ age # 1-D regression
hg.lm.age = lm(hg.form.age, data=dataset) # Whole population
hg.lmFi.age = lm(hg.form.age, data=dataset.fisherman) # Fishermen population
hg.lmNF.age = lm(hg.form.age, data=dataset.non_fisherman) # Control population
# Diagnostic plots
par(mfrow=c(2,2))
plot(hg.lm.age)
mtext("TotHg as a function of age - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.age)
mtext("TotHg as a function of age - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.age)
mtext("TotHg as a function of age - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.restime = TotHg ~ restime
hg.lm.restime = lm(hg.form.restime, data=dataset)
hg.lmFi.restime = lm(hg.form.restime, data=dataset.fisherman)
hg.lmNF.restime = lm(hg.form.restime, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.restime)
mtext("TotHg as a function of restime - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.restime)
mtext("TotHg as a function of restime - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.restime)
mtext("TotHg as a function of restime - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.logWeight = LogTotHg ~ weight
hg.lm.logWeight = lm(hg.form.logWeight, data=dataset)
hg.lmFi.logWeight = lm(hg.form.logWeight, data=dataset.fisherman)
hg.lmNF.logWeight = lm(hg.form.logWeight, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.logWeight)
mtext("LogTotHg as a function of weight - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.logWeight)
mtext("LogTotHg as a function of weight - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.logWeight)
mtext("LogTotHg as a function of weight - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.weight = TotHg ~ weight
hg.lm.weight = lm(hg.form.weight, data=dataset)
hg.lmFi.weight = lm(hg.form.weight, data=dataset.fisherman)
hg.lmNF.weight = lm(hg.form.weight, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.weight)
mtext("TotHg as a function of weight - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.weight)
mtext("TotHg as a function of weight - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.weight)
mtext("TotHg as a function of weight - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.height = TotHg ~ height
hg.lm.height = lm(hg.form.height, data=dataset)
hg.lmFi.height = lm(hg.form.height, data=dataset.fisherman)
hg.lmNF.height = lm(hg.form.height, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.height)
mtext("TotHg as a function of height - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.height)
mtext("TotHg as a function of height - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.height)
mtext("TotHg as a function of height - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fishmlwk = TotHg ~ fishmlwk
hg.lm.fishmlwk = lm(hg.form.fishmlwk, data=dataset)
hg.lmFi.fishmlwk = lm(hg.form.fishmlwk, data=dataset.fisherman)
hg.lmNF.fishmlwk = lm(hg.form.fishmlwk, data=dataset.non_fisherman)
par(mfrow=c(2,2))
plot(hg.lm.fishmlwk)
mtext("TotHg as a function of fishmlwk - Whole population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmFi.fishmlwk)
mtext("TotHg as a function of fishmlwk - Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
par(mfrow=c(2,2))
plot(hg.lmNF.fishmlwk)
mtext("TotHg as a function of fishmlwk - Non-Fishermen population", side = 3, line = -2, outer = TRUE, cex = 1.5)
hg.form.fisherman = TotHg ~ fisherman
hg.aov.fisherman = aov(hg.form.fisherman, data= dataset)
summary(hg.aov.fisherman)
<<<<<<< HEAD
hg.form.full = TotHg~restime + height + weight + fishmlwk + fishpart
fit <- lm(hg.form.full,data=dataset)
step <- stepAIC(fit, direction="both")
step$anova # display results
=======
>>>>>>> 719f9212dae05a4a9fb583dec70263c223de971f
